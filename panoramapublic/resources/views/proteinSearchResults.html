<div id="search-indicator"></div>
<script type="text/javascript" nonce="<%=getScriptNonce()%>">

    Ext4.onReady(function(){
        Ext4.create('Ext.panel.Panel', {
            border: false,
            renderTo: 'search-indicator',
        });
        Ext4.get('search-indicator').mask('Search is running, results pending...');

        let webpart = <%=webpartContext%>;
        const queryString = window.location.search;
        const urlParams = new URLSearchParams(queryString);
        const label = urlParams.get('proteinLabel');
        const exactMatch = urlParams.get('exactMatch');

        let wp = new LABKEY.QueryWebPart({
            renderTo: webpart.wrapperDivId,
            frame: 'portal',
            title: 'Search criteria : ' + label + ' & exact match: ' + exactMatch,
            schemaName: 'panoramapublic',
            queryName: 'proteinSearchResults',
            showFilterDescription: false,
            parameters: {proteinLabel : label, exactMatch: exactMatch},
            success: function () {
                if (Ext4.get('search-indicator')) {
                    Ext4.get('search-indicator').unmask();
                }
            }
        });
        wp.render();
    });

</script>